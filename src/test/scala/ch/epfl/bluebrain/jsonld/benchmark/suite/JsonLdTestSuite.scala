package ch.epfl.bluebrain.jsonld.benchmark.suite

import ch.epfl.bluebrain.jsonld.benchmark.utils.Resources
import ch.epfl.bluebrain.jsonld.benchmark.utils.Resources.jsonContentOf
import io.circe.Decoder
import org.apache.commons.io.FileUtils

final case class JsonLdTestSuite private (sequence: List[JsonLdTestEntry])

object JsonLdTestSuite extends Resources {

  val SUITE = "json-ld-11.org"

  final case class BaseIri(value: String)

  implicit val jsonLdTestEntriesDecoder: Decoder[JsonLdTestSuite] = Decoder.instance { hc =>
    hc.get[String]("baseIri").map(BaseIri).flatMap { implicit base =>
      hc.get[List[Option[JsonLdTestEntry]]]("sequence").map(list => JsonLdTestSuite(list.collect { case Some(v) => v }))
    }
  }

  // Most of the failures are due to unsupported 1.1 features
  // @version 1.1 in the @context
  // @none
  // @container does not support @id, @type, @graph
  // @type does not support @json
  // does not support list of lists
  // does not support direction on literal
  // does not embedded @context inside the @context
  // format: off
  val excludeJsonLdJava = Set("compact/0038-in.jsonld", "compact/0074-in.jsonld", "compact/0076-in.jsonld", "compact/0077-in.jsonld", "compact/0078-in.jsonld", "compact/0079-in.jsonld", "compact/0080-in.jsonld", "compact/0081-in.jsonld", "compact/0082-in.jsonld", "compact/0083-in.jsonld", "compact/0084-in.jsonld", "compact/0085-in.jsonld", "compact/0086-in.jsonld", "compact/0087-in.jsonld", "compact/0088-in.jsonld", "compact/0090-in.jsonld", "compact/0091-in.jsonld", "compact/0092-in.jsonld", "compact/0093-in.jsonld", "compact/0094-in.jsonld", "compact/0095-in.jsonld", "compact/0096-in.jsonld", "compact/0097-in.jsonld", "compact/0098-in.jsonld", "compact/0099-in.jsonld", "compact/0100-in.jsonld", "compact/0101-in.jsonld", "compact/0102-in.jsonld", "compact/0103-in.jsonld", "compact/0107-in.jsonld", "compact/0109-in.jsonld", "compact/0110-in.jsonld", "compact/c001-in.jsonld", "compact/c002-in.jsonld", "compact/c003-in.jsonld", "compact/c004-in.jsonld", "compact/c005-in.jsonld", "compact/c006-in.jsonld", "compact/c007-in.jsonld", "compact/c010-in.jsonld", "compact/c011-in.jsonld", "compact/c012-in.jsonld", "compact/c013-in.jsonld", "compact/c015-in.jsonld", "compact/c016-in.jsonld", "compact/c017-in.jsonld", "compact/c018-in.jsonld", "compact/c019-in.jsonld", "compact/c020-in.jsonld", "compact/c021-in.jsonld", "compact/c022-in.jsonld", "compact/c023-in.jsonld", "compact/c024-in.jsonld", "compact/c025-in.jsonld", "compact/c026-in.jsonld", "compact/c027-in.jsonld", "compact/di01-in.jsonld", "compact/di03-in.jsonld", "compact/di04-in.jsonld", "compact/di05-in.jsonld", "compact/di06-in.jsonld", "compact/di07-in.jsonld", "compact/in01-in.jsonld", "compact/in02-in.jsonld", "compact/in03-in.jsonld", "compact/in04-in.jsonld", "compact/in05-in.jsonld", "compact/js01-in.jsonld", "compact/js02-in.jsonld", "compact/js03-in.jsonld", "compact/js04-in.jsonld", "compact/js05-in.jsonld", "compact/js06-in.jsonld", "compact/js07-in.jsonld", "compact/js08-in.jsonld", "compact/js09-in.jsonld", "compact/js10-in.jsonld", "compact/js11-in.jsonld", "compact/li01-in.jsonld", "compact/li02-in.jsonld", "compact/li03-in.jsonld", "compact/li04-in.jsonld", "compact/li05-in.jsonld", "compact/m001-in.jsonld", "compact/m002-in.jsonld", "compact/m003-in.jsonld", "compact/m004-in.jsonld", "compact/m005-in.jsonld", "compact/m006-in.jsonld", "compact/m007-in.jsonld", "compact/m008-in.jsonld", "compact/m009-in.jsonld", "compact/m010-in.jsonld", "compact/m011-in.jsonld", "compact/m012-in.jsonld", "compact/m013-in.jsonld", "compact/m014-in.jsonld", "compact/m015-in.jsonld", "compact/m016-in.jsonld", "compact/m017-in.jsonld", "compact/m018-in.jsonld", "compact/m019-in.jsonld", "compact/m020-in.jsonld", "compact/m021-in.jsonld", "compact/m022-in.jsonld", "compact/m022-in.jsonld", "compact/c008-in.jsonld", "compact/di02-in.jsonld", "compact/n001-in.jsonld", "compact/n002-in.jsonld", "compact/n003-in.jsonld", "compact/n004-in.jsonld", "compact/n005-in.jsonld", "compact/n006-in.jsonld", "compact/n007-in.jsonld", "compact/n008-in.jsonld", "compact/n009-in.jsonld", "compact/n010-in.jsonld", "compact/n011-in.jsonld", "compact/p001-in.jsonld", "compact/p002-in.jsonld", "compact/p008-in.jsonld", "compact/pi01-in.jsonld", "compact/pi02-in.jsonld", "compact/pi03-in.jsonld", "compact/pi04-in.jsonld", "compact/pi05-in.jsonld", "compact/pi06-in.jsonld", "compact/pr04-in.jsonld", "compact/pr05-in.jsonld", "compact/s001-in.jsonld", "compact/s002-in.jsonld", "compact/tn01-in.jsonld", "compact/tn02-in.jsonld", "compact/tn03-in.jsonld", "expand/0079-in.jsonld", "expand/0080-in.jsonld", "expand/0081-in.jsonld", "expand/0082-in.jsonld", "expand/0083-in.jsonld", "expand/0084-in.jsonld", "expand/0085-in.jsonld", "expand/0086-in.jsonld", "expand/0087-in.jsonld", "expand/0088-in.jsonld", "expand/0092-in.jsonld", "expand/0093-in.jsonld", "expand/0094-in.jsonld", "expand/0095-in.jsonld", "expand/0096-in.jsonld", "expand/0097-in.jsonld", "expand/0098-in.jsonld", "expand/0099-in.jsonld", "expand/0100-in.jsonld", "expand/0101-in.jsonld", "expand/0102-in.jsonld", "expand/0103-in.jsonld", "expand/0104-in.jsonld", "expand/0105-in.jsonld", "expand/0106-in.jsonld", "expand/0107-in.jsonld", "expand/0108-in.jsonld", "expand/0109-in.jsonld", "expand/0110-in.jsonld", "expand/0111-in.jsonld", "expand/0112-in.jsonld", "expand/0114-in.jsonld", "expand/0117-in.jsonld", "expand/0118-in.jsonld", "expand/0119-in.jsonld", "expand/0120-in.jsonld", "expand/0122-in.jsonld", "expand/0124-in.jsonld", "expand/0125-in.jsonld", "expand/0126-in.jsonld", "expand/0127-in.jsonld", "expand/0128-in.jsonld", "expand/0129-in.jsonld", "expand/c001-in.jsonld", "expand/c002-in.jsonld", "expand/c003-in.jsonld", "expand/c004-in.jsonld", "expand/c005-in.jsonld", "expand/c006-in.jsonld", "expand/c007-in.jsonld", "expand/c008-in.jsonld", "expand/c010-in.jsonld", "expand/c011-in.jsonld", "expand/c012-in.jsonld", "expand/c013-in.jsonld", "expand/c014-in.jsonld", "expand/c015-in.jsonld", "expand/c016-in.jsonld", "expand/c017-in.jsonld", "expand/c018-in.jsonld", "expand/c019-in.jsonld", "expand/c020-in.jsonld", "expand/c021-in.jsonld", "expand/c022-in.jsonld", "expand/c023-in.jsonld", "expand/c024-in.jsonld", "expand/c025-in.jsonld", "expand/c026-in.jsonld", "expand/c027-in.jsonld", "expand/c028-in.jsonld", "expand/c031-in.jsonld", "expand/c034-in.jsonld", "expand/di01-in.jsonld", "expand/di02-in.jsonld", "expand/di03-in.jsonld", "expand/di04-in.jsonld", "expand/di05-in.jsonld", "expand/di06-in.jsonld", "expand/di07-in.jsonld", "expand/in01-in.jsonld", "expand/in02-in.jsonld", "expand/in03-in.jsonld", "expand/in04-in.jsonld", "expand/in05-in.jsonld", "expand/in06-in.jsonld", "expand/js01-in.jsonld", "expand/js02-in.jsonld", "expand/js03-in.jsonld", "expand/js04-in.jsonld", "expand/js05-in.jsonld", "expand/js06-in.jsonld", "expand/js07-in.jsonld", "expand/js08-in.jsonld", "expand/js09-in.jsonld", "expand/js10-in.jsonld", "expand/js11-in.jsonld", "expand/js12-in.jsonld", "expand/js13-in.jsonld", "expand/js14-in.jsonld", "expand/js15-in.jsonld", "expand/js16-in.jsonld", "expand/js17-in.jsonld", "expand/js18-in.jsonld", "expand/js19-in.jsonld", "expand/js20-in.jsonld", "expand/js21-in.jsonld", "expand/js22-in.jsonld", "expand/js23-in.jsonld", "expand/l001-in.jsonld", "expand/li01-in.jsonld", "expand/li02-in.jsonld", "expand/li03-in.jsonld", "expand/li04-in.jsonld", "expand/li05-in.jsonld", "expand/li06-in.jsonld", "expand/li07-in.jsonld", "expand/li08-in.jsonld", "expand/li09-in.jsonld", "expand/li10-in.jsonld", "expand/m001-in.jsonld", "expand/m002-in.jsonld", "expand/m003-in.jsonld", "expand/m004-in.jsonld", "expand/m005-in.jsonld", "expand/m006-in.jsonld", "expand/m007-in.jsonld", "expand/m008-in.jsonld", "expand/m009-in.jsonld", "expand/m010-in.jsonld", "expand/m011-in.jsonld", "expand/m012-in.jsonld", "expand/m013-in.jsonld", "expand/m014-in.jsonld", "expand/m015-in.jsonld", "expand/m016-in.jsonld", "expand/m017-in.jsonld", "expand/m018-in.jsonld", "expand/m019-in.jsonld", "expand/n001-in.jsonld", "expand/n002-in.jsonld", "expand/n003-in.jsonld", "expand/n004-in.jsonld", "expand/n005-in.jsonld", "expand/n006-in.jsonld", "expand/n007-in.jsonld", "expand/n008-in.jsonld", "expand/p001-in.jsonld", "expand/p002-in.jsonld", "expand/p003-in.jsonld", "expand/p004-in.jsonld", "expand/pi06-in.jsonld", "expand/pi07-in.jsonld", "expand/pi08-in.jsonld", "expand/pi09-in.jsonld", "expand/pi10-in.jsonld", "expand/pi11-in.jsonld", "expand/pr02-in.jsonld", "expand/pr06-in.jsonld", "expand/pr10-in.jsonld", "expand/pr13-in.jsonld", "expand/pr14-in.jsonld", "expand/pr15-in.jsonld", "expand/pr16-in.jsonld", "expand/pr19-in.jsonld", "expand/pr22-in.jsonld", "expand/pr23-in.jsonld", "expand/pr24-in.jsonld", "expand/pr25-in.jsonld", "expand/pr27-in.jsonld", "expand/pr29-in.jsonld", "expand/pr30-in.jsonld", "expand/pr34-in.jsonld", "expand/pr35-in.jsonld", "expand/pr36-in.jsonld", "expand/pr37-in.jsonld", "expand/pr38-in.jsonld", "expand/pr39-in.jsonld", "expand/pr40-in.jsonld", "expand/so05-in.jsonld", "expand/so06-in.jsonld", "expand/so08-in.jsonld", "expand/so09-in.jsonld", "expand/so11-in.jsonld", "expand/tn02-in.jsonld", "flatten/in01-in.jsonld", "flatten/in02-in.jsonld", "flatten/in03-in.jsonld", "flatten/in04-in.jsonld", "flatten/in05-in.jsonld", "flatten/in06-in.jsonld", "flatten/li01-in.jsonld", "flatten/li02-in.jsonld", "flatten/li03-in.jsonld", "frame/0023-in.jsonld", "frame/0024-in.jsonld", "frame/0028-in.jsonld", "frame/0029-in.jsonld", "frame/0031-in.jsonld", "frame/0034-in.jsonld", "frame/0037-in.jsonld", "frame/0038-in.jsonld", "frame/0039-in.jsonld", "frame/0040-in.jsonld", "frame/0041-in.jsonld", "frame/0042-in.jsonld", "frame/0043-in.jsonld", "frame/0044-in.jsonld", "frame/0045-in.jsonld", "frame/0047-in.jsonld", "frame/0048-in.jsonld", "frame/0049-in.jsonld", "frame/0050-in.jsonld", "frame/0051-in.jsonld", "frame/0055-in.jsonld", "frame/0056-in.jsonld", "frame/0057-in.jsonld", "frame/0058-in.jsonld", "frame/0060-in.jsonld", "frame/0061-in.jsonld", "frame/0062-in.jsonld", "frame/0063-in.jsonld", "frame/0064-in.jsonld", "frame/0065-in.jsonld", "frame/0066-in.jsonld", "frame/0067-in.jsonld", "frame/0068-in.jsonld", "frame/eo01-in.jsonld", "frame/g005-in.jsonld","frame/g008-in.jsonld", "frame/in01-in.jsonld", "frame/in02-in.jsonld", "frame/in03-in.jsonld", "frame/0049-in.jsonld", "frame/ra01-in.jsonld", "frame/ra02-in.jsonld", "frame/ra03-in.jsonld", "frame/g010-in.jsonld", "fromRdf/0020-in.nq", "fromRdf/0021-in.nq", "fromRdf/0026-in.nq", "fromRdf/di05-in.nq", "fromRdf/di06-in.nq", "fromRdf/di11-in.nq", "fromRdf/di12-in.nq", "fromRdf/js01-in.nq", "fromRdf/js02-in.nq", "fromRdf/js03-in.nq", "fromRdf/js04-in.nq", "fromRdf/js05-in.nq", "fromRdf/js06-in.nq", "fromRdf/js07-in.nq", "fromRdf/js10-in.nq", "fromRdf/js11-in.nq", "fromRdf/li01-in.nq", "fromRdf/li02-in.nq", "fromRdf/li02-in.nq", "toRdf/0126-in.jsonld", "toRdf/0128-in.jsonld", "toRdf/c001-in.jsonld", "toRdf/c002-in.jsonld", "toRdf/c003-in.jsonld", "toRdf/c004-in.jsonld", "toRdf/c005-in.jsonld", "toRdf/c006-in.jsonld", "toRdf/c007-in.jsonld", "toRdf/c008-in.jsonld", "toRdf/c010-in.jsonld", "toRdf/c011-in.jsonld", "toRdf/c012-in.jsonld", "toRdf/c013-in.jsonld", "toRdf/c014-in.jsonld", "toRdf/c015-in.jsonld", "toRdf/c016-in.jsonld", "toRdf/c017-in.jsonld", "toRdf/c018-in.jsonld", "toRdf/c019-in.jsonld", "toRdf/c020-in.jsonld", "toRdf/c021-in.jsonld", "toRdf/c022-in.jsonld", "toRdf/c023-in.jsonld", "toRdf/c024-in.jsonld", "toRdf/c025-in.jsonld", "toRdf/c026-in.jsonld", "toRdf/c027-in.jsonld", "toRdf/c028-in.jsonld", "toRdf/c031-in.jsonld", "toRdf/c034-in.jsonld", "toRdf/di01-in.jsonld", "toRdf/di02-in.jsonld", "toRdf/di03-in.jsonld", "toRdf/di04-in.jsonld", "toRdf/di05-in.jsonld", "toRdf/di06-in.jsonld", "toRdf/di07-in.jsonld", "toRdf/di09-in.jsonld", "toRdf/di10-in.jsonld", "toRdf/di11-in.jsonld", "toRdf/di12-in.jsonld", "toRdf/e029-in.jsonld", "toRdf/e060-in.jsonld", "toRdf/e066-in.jsonld", "toRdf/e073-in.jsonld", "toRdf/e075-in.jsonld", "toRdf/e078-in.jsonld", "toRdf/e079-in.jsonld", "toRdf/e080-in.jsonld", "toRdf/e081-in.jsonld", "toRdf/e082-in.jsonld", "toRdf/e083-in.jsonld", "toRdf/e084-in.jsonld", "toRdf/e085-in.jsonld", "toRdf/e086-in.jsonld", "toRdf/e087-in.jsonld", "toRdf/e088-in.jsonld", "toRdf/e092-in.jsonld", "toRdf/e093-in.jsonld", "toRdf/e094-in.jsonld", "toRdf/e095-in.jsonld", "toRdf/e096-in.jsonld", "toRdf/e097-in.jsonld", "toRdf/e098-in.jsonld", "toRdf/e099-in.jsonld", "toRdf/e100-in.jsonld", "toRdf/e101-in.jsonld", "toRdf/e102-in.jsonld", "toRdf/e103-in.jsonld", "toRdf/e104-in.jsonld", "toRdf/e105-in.jsonld", "toRdf/e106-in.jsonld", "toRdf/e107-in.jsonld", "toRdf/e108-in.jsonld", "toRdf/e109-in.jsonld", "toRdf/e110-in.jsonld", "toRdf/e111-in.jsonld", "toRdf/e112-in.jsonld", "toRdf/e114-in.jsonld", "toRdf/e117-in.jsonld", "toRdf/e118-in.jsonld", "toRdf/e119-in.jsonld", "toRdf/e120-in.jsonld", "toRdf/e121-in.jsonld", "toRdf/e122-in.jsonld", "toRdf/e124-in.jsonld", "toRdf/e125-in.jsonld", "toRdf/e126-in.jsonld", "toRdf/e127-in.jsonld", "toRdf/e128-in.jsonld", "toRdf/e129-in.jsonld", "toRdf/in01-in.jsonld", "toRdf/in02-in.jsonld", "toRdf/in03-in.jsonld", "toRdf/in04-in.jsonld", "toRdf/in05-in.jsonld", "toRdf/in06-in.jsonld", "toRdf/js02-in.jsonld", "toRdf/js03-in.jsonld", "toRdf/js04-in.jsonld", "toRdf/js05-in.jsonld", "toRdf/js06-in.jsonld", "toRdf/js07-in.jsonld", "toRdf/js08-in.jsonld", "toRdf/js09-in.jsonld", "toRdf/js10-in.jsonld", "toRdf/js11-in.jsonld", "toRdf/js12-in.jsonld", "toRdf/js13-in.jsonld", "toRdf/js14-in.jsonld", "toRdf/js15-in.jsonld", "toRdf/js16-in.jsonld", "toRdf/js17-in.jsonld", "toRdf/js18-in.jsonld", "toRdf/js19-in.jsonld", "toRdf/js20-in.jsonld", "toRdf/js21-in.jsonld", "toRdf/js22-in.jsonld", "toRdf/js23-in.jsonld", "toRdf/li01-in.jsonld", "toRdf/li02-in.jsonld", "toRdf/li03-in.jsonld", "toRdf/li04-in.jsonld", "toRdf/li05-in.jsonld", "toRdf/li06-in.jsonld", "toRdf/li07-in.jsonld", "toRdf/li08-in.jsonld", "toRdf/li09-in.jsonld", "toRdf/li10-in.jsonld", "toRdf/li11-in.jsonld", "toRdf/li12-in.jsonld", "toRdf/li14-in.jsonld", "toRdf/m001-in.jsonld", "toRdf/m002-in.jsonld", "toRdf/m003-in.jsonld", "toRdf/m003-in.jsonld", "toRdf/m004-in.jsonld", "toRdf/m005-in.jsonld", "toRdf/m006-in.jsonld", "toRdf/m007-in.jsonld", "toRdf/m008-in.jsonld", "toRdf/m009-in.jsonld", "toRdf/m010-in.jsonld", "toRdf/m011-in.jsonld", "toRdf/m012-in.jsonld", "toRdf/m013-in.jsonld", "toRdf/m014-in.jsonld", "toRdf/m015-in.jsonld", "toRdf/m016-in.jsonld", "toRdf/m017-in.jsonld", "toRdf/m018-in.jsonld", "toRdf/m019-in.jsonld", "toRdf/n001-in.jsonld", "toRdf/n002-in.jsonld", "toRdf/n003-in.jsonld", "toRdf/n004-in.jsonld", "toRdf/n005-in.jsonld", "toRdf/n006-in.jsonld", "toRdf/n007-in.jsonld", "toRdf/n008-in.jsonld", "toRdf/p001-in.jsonld", "toRdf/p002-in.jsonld", "toRdf/p003-in.jsonld", "toRdf/p004-in.jsonld", "toRdf/pi06-in.jsonld", "toRdf/pi07-in.jsonld", "toRdf/pi08-in.jsonld", "toRdf/pi09-in.jsonld", "toRdf/pi10-in.jsonld", "toRdf/pi11-in.jsonld", "toRdf/pr02-in.jsonld", "toRdf/pr06-in.jsonld", "toRdf/pr10-in.jsonld", "toRdf/pr13-in.jsonld", "toRdf/pr14-in.jsonld", "toRdf/pr15-in.jsonld", "toRdf/pr16-in.jsonld", "toRdf/pr19-in.jsonld", "toRdf/pr22-in.jsonld", "toRdf/pr23-in.jsonld", "toRdf/pr24-in.jsonld", "toRdf/pr25-in.jsonld", "toRdf/pr27-in.jsonld", "toRdf/pr29-in.jsonld", "toRdf/pr30-in.jsonld", "toRdf/pr34-in.jsonld", "toRdf/pr35-in.jsonld", "toRdf/pr36-in.jsonld", "toRdf/pr37-in.jsonld", "toRdf/pr38-in.jsonld", "toRdf/pr39-in.jsonld", "toRdf/pr40-in.jsonld", "toRdf/rt01-in.jsonld", "toRdf/so05-in.jsonld", "toRdf/so06-in.jsonld", "toRdf/so08-in.jsonld", "toRdf/so09-in.jsonld", "toRdf/so11-in.jsonld", "toRdf/tn02-in.jsonld", "toRdf/wf01-in.jsonld", "toRdf/wf02-in.jsonld", "toRdf/wf03-in.jsonld", "toRdf/wf04-in.jsonld", "toRdf/wf05-in.jsonld", "toRdf/wf07-in.jsonld")
  // format: on

  // format: off
  val excludePassedTitaniumButWrongEquality = Set("toRdf/di10-in.jsonld", "toRdf/di11-in.jsonld", "toRdf/di12-in.jsonld", "toRdf/e085-in.jsonld", "toRdf/e086-in.jsonld", "toRdf/e087-in.jsonld", "toRdf/li09-in.jsonld", "toRdf/li10-in.jsonld")
  // format: on

  // Most of these failures are just due to the fact that JsonLdOpts replaces the @base from the @context @base
  // format: off
  val excludeTitanium = Set("frame/0056-in.jsonld", "frame/0057-in.jsonld", "frame/0059-in.jsonld", "frame/0065-in.jsonld", "frame/0066-in.jsonld", "frame/0067-in.jsonld", "frame/g010-in.jsonld", "frame/ra03-in.jsonld", "toRdf/c019-in.jsonld", "toRdf/di09-in.jsonld", "toRdf/e036-in.jsonld", "toRdf/e075-in.jsonld", "toRdf/js13-in.jsonld", "toRdf/li12-in.jsonld", "toRdf/m003-in.jsonld", "toRdf/m004-in.jsonld", "toRdf/pr25-in.jsonld")
  // format: on

  // Exclude for benchmarks, since the external context endpoint is rejecting the HTTP request. It could be fixed mocking the HttpClient
  val excludeRemoteContext = Set("expand/0077-in.jsonld", "toRdf/e077-in.jsonld", "toRdf/js01-in.jsonld")

  final def apply(manifestType: String, exclude: Set[String]): Seq[JsonLdTestEntry] =
    jsonContentOf(s"/$SUITE/$manifestType-manifest.jsonld")
      .as[JsonLdTestSuite]
      .toOption
      .get
      .sequence
      .filterNot(_.hasSpecVersion10)
      .filterNot(e => exclude.contains(e.inputPath))

  final def apply(exclude: Set[String]): Seq[JsonLdTestEntry] =
    List("compact", "expand", "flatten", "frame", "fromRdf", "toRdf").foldLeft(List.empty[JsonLdTestEntry]) {
      (acc, c) => acc ++ apply(c, exclude)
    }

}
